{"ast":null,"code":"import \"antd/es/button/style\";\nimport _Button from \"antd/es/button\";\nimport \"antd/es/card/style\";\nimport _Card from \"antd/es/card\";\nimport \"antd/es/input/style\";\nimport _Input from \"antd/es/input\";\nimport \"antd/es/cascader/style\";\nimport _Cascader from \"antd/es/cascader\";\nimport _objectSpread from \"/Users/yangshuyu/job/h5/replace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/yangshuyu/job/h5/replace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/yangshuyu/job/h5/replace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/yangshuyu/job/h5/replace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/yangshuyu/job/h5/replace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/yangshuyu/job/h5/replace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport \"antd/es/select/style\";\nimport _Select from \"antd/es/select\";\nimport \"antd/es/form/style\";\nimport _Form from \"antd/es/form\";\nvar _jsxFileName = \"/Users/yangshuyu/job/h5/replace/src/components/replace/Eliminate.jsx\";\n\n/**\n * Created by hao.cheng on 2017/4/13.\n */\nimport React, { Component } from 'react';\nimport BreadcrumbCustom from '../BreadcrumbCustom';\nimport EliminateSelectTable from './EliminateSelectTable';\nimport axios from 'axios';\nvar FormItem = _Form.Item;\nvar Option = _Select.Option;\nvar url = 'http://localhost:5000/v1';\n\nvar EliminateComponent =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(EliminateComponent, _Component);\n\n  function EliminateComponent() {\n    var _getPrototypeOf2;\n\n    var _this2;\n\n    _classCallCheck(this, EliminateComponent);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this2 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(EliminateComponent)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this2.state = {\n      confirmDirty: false,\n      residences: [],\n      storage_areas: [{\n        value: '无',\n        label: '无'\n      }],\n      strategy: [{\n        value: '类别内销售最差',\n        label: '类别内销售最差'\n      }, {\n        value: '小类中销售最差',\n        label: '小类中销售最差'\n      }],\n      elimination_rule: [{\n        value: '店均销售量',\n        label: '店均销售量'\n      }, {\n        value: '毛利率',\n        label: '毛利率'\n      }],\n      data: [],\n      chain_category: '',\n      storage_area: ''\n    };\n\n    _this2.handleSubmit = function () {\n      // e.preventDefault();\n      _this2.props.form.validateFieldsAndScroll(function (err, values) {\n        if (!err) {\n          console.log('Received values of form: ', values);\n        }\n\n        var elimination_rule = values.elimination_rule[0];\n        var strategy = values.strategy[0];\n        var eliminate_amount = values.eliminate_amount;\n\n        if (strategy == '类别内销售最差') {\n          strategy = 0;\n        } else {\n          strategy = 1;\n        }\n\n        if (elimination_rule == '店均销售量') {\n          elimination_rule = 0;\n        } else {\n          elimination_rule = 1;\n        }\n\n        axios.get(url + '/goods/eliminate', {\n          params: {\n            'chain_category': _this2.state.chain_category,\n            'storage_area': _this2.state.storage_area,\n            'eliminate_amount': eliminate_amount,\n            'elimination_rule': elimination_rule,\n            'strategy': strategy\n          }\n        }).then(function (response) {\n          var options = [];\n          response.data.data.map(function (item) {\n            item.average_store_quantity = item.average_store_quantity + '(' + item.store_quantity_rank + ')';\n            item.quantity = item.quantity + '(' + item.quantity_rank + ')';\n            item.sale = item.sale + '(' + item.sale + ')';\n            item.profit = item.profit + '(' + item.profit_rank + ')';\n            options.push(item);\n          });\n\n          _this2.setState({\n            data: options,\n            isLoaded: true\n          });\n        }).catch(function (response) {\n          console.log(response);\n\n          _this2.setState({\n            isLoaded: false,\n            error: response\n          });\n        });\n      });\n    };\n\n    _this2.onCategoryChange = function (value, selectedOptions) {\n      console.log(value);\n      console.log(selectedOptions.length);\n\n      _this2.setState({\n        chain_category: selectedOptions[selectedOptions.length - 1].value\n      });\n\n      var onChange = _this2.props.onChange;\n\n      if (onChange) {\n        onChange(_objectSpread({}, value));\n      }\n    };\n\n    _this2.onAreaChange = function (value, selectedOptions) {\n      console.log(value);\n      console.log(selectedOptions);\n\n      _this2.setState({\n        storage_area: selectedOptions[selectedOptions.length - 1].value\n      });\n\n      var onChange = _this2.props.onChange;\n\n      if (onChange) {\n        onChange(_objectSpread({}, value));\n      }\n    };\n\n    return _this2;\n  }\n\n  _createClass(EliminateComponent, [{\n    key: \"child_data\",\n    value: function child_data(data) {\n      var _this3 = this;\n\n      console.log('这是一个data');\n      console.log(data);\n      axios.post(url + '/replace_goods', {\n        'foreign_item_id': data.foreign_item_id,\n        'item_status': '正常'\n      }).then(function (response) {\n        var foreign_item_id = response.data.data.foreign_item_id;\n        var list = _this3.state.data;\n        list.splice(list.findIndex(function (data) {\n          return data.foreign_item_id === foreign_item_id;\n        }), 1);\n\n        _this3.setState({\n          data: list,\n          isLoaded: true\n        });\n      }).catch(function (response) {\n        console.log(response);\n\n        _this3.setState({\n          isLoaded: false,\n          error: response\n        });\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this = this;\n\n      axios.get(url + '/categories').then(function (response) {\n        var options = [];\n        response.data.data.map(function (item) {\n          options.push({\n            value: item.id,\n            label: item.name,\n            children: item.foreign_category_lv2s.map(function (lv2) {\n              return {\n                value: lv2.id,\n                label: lv2.name,\n                children: lv2.foreign_category_lv3s.map(function (lv3) {\n                  return {\n                    value: lv3.id,\n                    label: lv3.name,\n                    children: lv3.foreign_category_lv4s.map(function (lv4) {\n                      return {\n                        value: lv4.id,\n                        label: lv4.name\n                      };\n                    })\n                  };\n                })\n              };\n            })\n          });\n        });\n\n        _this.setState({\n          residences: options,\n          isLoaded: true\n        });\n      }).catch(function (error) {\n        console.log(error);\n\n        _this.setState({\n          isLoaded: false,\n          error: error\n        });\n      });\n      axios.get(url + '/storage_area').then(function (response) {\n        var options = [{\n          value: '无',\n          label: '无'\n        }];\n        response.data.data.map(function (item) {\n          console.log(item);\n          options.push({\n            value: item.storage_area,\n            label: item.storage_area\n          });\n        });\n\n        _this.setState({\n          storage_areas: options,\n          isLoaded: true\n        });\n      }).catch(function (error) {\n        console.log(error);\n\n        _this.setState({\n          isLoaded: false,\n          error: error\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      var getFieldDecorator = this.props.form.getFieldDecorator;\n      var formItemLayout = {\n        labelCol: {\n          xs: {\n            span: 24\n          },\n          sm: {\n            span: 8\n          }\n        },\n        wrapperCol: {\n          xs: {\n            span: 24\n          },\n          sm: {\n            span: 14\n          }\n        }\n      };\n      return React.createElement(\"div\", {\n        className: \"gutter-example\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 245\n        },\n        __self: this\n      }, React.createElement(BreadcrumbCustom, {\n        first: \"\\u6C70\\u6362\",\n        second: \"\\u6DD8\\u6C70\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246\n        },\n        __self: this\n      }), React.createElement(_Form, {\n        layout: \"inline\",\n        onSubmit: function onSubmit() {\n          return _this4.handleSubmit();\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"gutter-box\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 249\n        },\n        __self: this\n      }, React.createElement(_Card, {\n        title: \"\\u6C34\\u5E73\\u8868\\u5355\",\n        bordered: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250\n        },\n        __self: this\n      }, React.createElement(FormItem, Object.assign({}, formItemLayout, {\n        label: \"\\u6DD8\\u6C70\\u7B56\\u7565\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252\n        },\n        __self: this\n      }), getFieldDecorator('strategy', {\n        initialValue: ['类别内销售最差'],\n        rules: [{\n          type: 'array',\n          required: true,\n          message: '请选择淘汰策略!'\n        }]\n      })(React.createElement(_Cascader, {\n        options: this.state.strategy,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }))), React.createElement(FormItem, Object.assign({}, formItemLayout, {\n        label: \"\\u6838\\u5FC3\\u6307\\u6807\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }), getFieldDecorator('elimination_rule', {\n        initialValue: ['店均销售量'],\n        rules: [{\n          type: 'array',\n          required: true,\n          message: '请选择核心指标!'\n        }]\n      })(React.createElement(_Cascader, {\n        options: this.state.elimination_rule,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 273\n        },\n        __self: this\n      }))), React.createElement(FormItem, Object.assign({}, formItemLayout, {\n        label: \"\\u5E97\\u5185\\u5206\\u533A\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278\n        },\n        __self: this\n      }), getFieldDecorator('storage_area', {\n        initialValue: ['无'],\n        rules: [{\n          type: 'array',\n          required: false,\n          message: '请选择店内分区!'\n        }]\n      })(React.createElement(_Cascader, {\n        options: this.state.storage_areas,\n        onChange: this.onAreaChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 286\n        },\n        __self: this\n      }))), React.createElement(FormItem, Object.assign({}, formItemLayout, {\n        label: \"\\u5546\\u54C1\\u5206\\u7C7B\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292\n        },\n        __self: this\n      }), getFieldDecorator('category', {\n        rules: [{\n          type: 'array',\n          required: true,\n          message: '商品分类!'\n        }]\n      })(React.createElement(_Cascader, {\n        options: this.state.residences,\n        onChange: this.onCategoryChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 299\n        },\n        __self: this\n      }))), React.createElement(FormItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 304\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 305\n        },\n        __self: this\n      }, \"\\u6C70\\u54C1\\u4E2A\\u6570\")), React.createElement(FormItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 308\n        },\n        __self: this\n      }, getFieldDecorator('eliminate_amount', {\n        initialValue: 3,\n        rules: [{\n          required: true,\n          message: '汰品个数'\n        }]\n      })(React.createElement(_Input, {\n        placeholder: \"\\u6C70\\u54C1\\u4E2A\\u6570\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 313\n        },\n        __self: this\n      })))), React.createElement(_Card, {\n        bordered: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 319\n        },\n        __self: this\n      }, React.createElement(FormItem, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 320\n        },\n        __self: this\n      }, React.createElement(_Button, {\n        type: \"primary\",\n        htmlType: \"submit\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 321\n        },\n        __self: this\n      }, \"\\u8BA1\\u7B97\"))))), React.createElement(_Card, {\n        title: \"\\u6DD8\\u6C70\\u6570\\u636E\",\n        bordered: false,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 333\n        },\n        __self: this\n      }, React.createElement(EliminateSelectTable, {\n        data: this.state.data,\n        pfn: this.child_data.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 334\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return EliminateComponent;\n}(Component);\n\nvar Eliminate = _Form.create()(EliminateComponent);\n\nexport default Eliminate;","map":{"version":3,"sources":["/Users/yangshuyu/job/h5/replace/src/components/replace/Eliminate.jsx"],"names":["React","Component","BreadcrumbCustom","EliminateSelectTable","axios","FormItem","Item","Option","url","EliminateComponent","state","confirmDirty","residences","storage_areas","value","label","strategy","elimination_rule","data","chain_category","storage_area","handleSubmit","props","form","validateFieldsAndScroll","err","values","console","log","eliminate_amount","get","params","then","response","options","map","item","average_store_quantity","store_quantity_rank","quantity","quantity_rank","sale","profit","profit_rank","push","setState","isLoaded","catch","error","onCategoryChange","selectedOptions","length","onChange","onAreaChange","post","foreign_item_id","list","splice","findIndex","_this","id","name","children","foreign_category_lv2s","lv2","foreign_category_lv3s","lv3","foreign_category_lv4s","lv4","getFieldDecorator","formItemLayout","labelCol","xs","span","sm","wrapperCol","initialValue","rules","type","required","message","child_data","bind","Eliminate","create"],"mappings":"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","sourcesContent":["/**\n * Created by hao.cheng on 2017/4/13.\n */\nimport React, {Component} from 'react';\nimport {Card, Form, Input, Tooltip, Icon, Cascader, Select, Row, Col, Checkbox, Button} from 'antd';\nimport BreadcrumbCustom from '../BreadcrumbCustom';\nimport EliminateSelectTable from './EliminateSelectTable'\nimport axios from 'axios'\nconst FormItem = Form.Item;\nconst Option = Select.Option;\n\nconst url = 'http://localhost:5000/v1'\n\nclass EliminateComponent extends Component {\n    state = {\n        confirmDirty: false,\n        residences: [],\n        storage_areas: [{\n            value: '无',\n            label: '无'\n        }],\n        strategy: [{\n            value: '类别内销售最差',\n            label: '类别内销售最差',\n\n        }, {\n            value: '小类中销售最差',\n            label: '小类中销售最差',\n        }],\n        elimination_rule: [\n            {\n                value: '店均销售量',\n                label: '店均销售量',\n\n            }, {\n                value: '毛利率',\n                label: '毛利率',\n            }\n        ],\n        data: [],\n        chain_category: '',\n        storage_area: ''\n\n    };\n\n\n    child_data(data) {\n        console.log('这是一个data')\n        console.log(data)\n        axios.post(url + '/replace_goods', {\n                'foreign_item_id': data.foreign_item_id,\n                'item_status': '正常'\n            }\n        )\n            .then((response) => {\n                var foreign_item_id = response.data.data.foreign_item_id\n                let list = this.state.data;\n                list.splice(list.findIndex(data => data.foreign_item_id === foreign_item_id), 1);\n                this.setState({\n                    data: list,\n                    isLoaded: true\n                });\n            })\n            .catch((response) => {\n                console.log(response);\n                this.setState({\n                    isLoaded: false,\n                    error: response\n                })\n            })\n    }\n\n    componentDidMount() {\n        const _this = this;\n        axios.get(url + '/categories')\n            .then(function (response) {\n                var options = []\n                response.data.data.map(item => {\n                    options.push({\n                        value: item.id,\n                        label: item.name,\n                        children: item.foreign_category_lv2s.map(lv2 => {\n                            return {\n                                value: lv2.id,\n                                label: lv2.name,\n                                children: lv2.foreign_category_lv3s.map(lv3 => {\n                                    return {\n                                        value: lv3.id,\n                                        label: lv3.name,\n                                        children: lv3.foreign_category_lv4s.map(lv4 => {\n                                            return {\n                                                value: lv4.id,\n                                                label: lv4.name,\n                                            }\n                                        })\n                                    }\n                                })\n                            }\n                        })\n                    })\n\n                })\n\n\n                _this.setState({\n                    residences: options,\n                    isLoaded: true\n                });\n            })\n            .catch(function (error) {\n                console.log(error);\n                _this.setState({\n                    isLoaded: false,\n                    error: error\n                })\n            })\n\n        axios.get(url + '/storage_area')\n            .then(function (response) {\n                var options = [{\n                    value: '无',\n                    label: '无'\n                }]\n                response.data.data.map(item => {\n                    console.log(item);\n                    options.push({\n                        value: item.storage_area,\n                        label: item.storage_area\n                    })\n\n                })\n\n                _this.setState({\n                    storage_areas: options,\n                    isLoaded: true\n                });\n            })\n            .catch(function (error) {\n                console.log(error);\n                _this.setState({\n                    isLoaded: false,\n                    error: error\n                })\n            })\n\n    }\n\n    handleSubmit = () => {\n        // e.preventDefault();\n        this.props.form.validateFieldsAndScroll((err, values) => {\n            if (!err) {\n                console.log('Received values of form: ', values);\n            }\n            var elimination_rule = values.elimination_rule[0]\n            var strategy = values.strategy[0]\n            var eliminate_amount = values.eliminate_amount\n\n            if (strategy == '类别内销售最差') {\n                strategy = 0\n            } else {\n                strategy = 1\n            }\n            if (elimination_rule == '店均销售量') {\n                elimination_rule = 0\n            } else {\n                elimination_rule = 1\n            }\n\n            axios.get(url + '/goods/eliminate', {\n                params: {\n                    'chain_category': this.state.chain_category,\n                    'storage_area': this.state.storage_area,\n                    'eliminate_amount': eliminate_amount,\n                    'elimination_rule': elimination_rule,\n                    'strategy': strategy\n                }\n            })\n                .then((response) => {\n                    var options = []\n                    response.data.data.map(item => {\n                        item.average_store_quantity = item.average_store_quantity + '(' + item.store_quantity_rank + ')'\n                        item.quantity = item.quantity + '(' + item.quantity_rank + ')'\n                        item.sale = item.sale + '(' + item.sale + ')'\n                        item.profit = item.profit + '(' + item.profit_rank + ')'\n                        options.push(item)\n                    })\n\n                    this.setState({\n                        data: options,\n                        isLoaded: true\n                    });\n                })\n                .catch((response)=> {\n                    console.log(response);\n                    this.setState({\n                        isLoaded: false,\n                        error: response\n                    })\n                })\n\n        });\n    };\n\n    onCategoryChange = (value, selectedOptions) => {\n        console.log(value);\n        console.log(selectedOptions.length)\n        this.setState({\n            chain_category: selectedOptions[selectedOptions.length - 1].value\n        });\n        const onChange = this.props.onChange;\n\n        if (onChange) {\n            onChange({...value});\n        }\n    }\n\n    onAreaChange = (value, selectedOptions) => {\n        console.log(value);\n        console.log(selectedOptions)\n        this.setState({\n            storage_area: selectedOptions[selectedOptions.length - 1].value\n        });\n        const onChange = this.props.onChange;\n\n        if (onChange) {\n            onChange({...value});\n        }\n    }\n\n\n    render() {\n        const {getFieldDecorator} = this.props.form;\n        const formItemLayout = {\n            labelCol: {\n                xs: {span: 24},\n                sm: {span: 8},\n            },\n            wrapperCol: {\n                xs: {span: 24},\n                sm: {span: 14},\n            },\n        };\n\n        return (\n            <div className=\"gutter-example\">\n                <BreadcrumbCustom first=\"汰换\" second=\"淘汰\"/>\n\n                <Form layout=\"inline\" onSubmit={()=>this.handleSubmit()}>\n                    <div className=\"gutter-box\">\n                        <Card title=\"水平表单\" bordered={false}>\n\n                            <FormItem\n                                {...formItemLayout}\n                                label=\"淘汰策略\"\n                            >\n                                {getFieldDecorator('strategy', {\n                                    initialValue: ['类别内销售最差'],\n                                    rules: [{type: 'array', required: true, message: '请选择淘汰策略!'}],\n                                })(\n                                    <Cascader options={this.state.strategy}/>\n                                )}\n\n                            </FormItem>\n\n                            <FormItem\n                                {...formItemLayout}\n                                label=\"核心指标\"\n                            >\n                                {getFieldDecorator('elimination_rule', {\n                                    initialValue: ['店均销售量'],\n                                    rules: [{type: 'array', required: true, message: '请选择核心指标!'}],\n                                })(\n                                    <Cascader options={this.state.elimination_rule}/>\n                                )}\n\n                            </FormItem>\n\n                            <FormItem\n                                {...formItemLayout}\n                                label=\"店内分区\"\n                            >\n                                {getFieldDecorator('storage_area', {\n                                    initialValue: ['无'],\n                                    rules: [{type: 'array', required: false, message: '请选择店内分区!'}],\n                                })(\n                                    <Cascader options={this.state.storage_areas} onChange={this.onAreaChange}/>\n                                )}\n\n                            </FormItem>\n\n\n                            <FormItem\n                                {...formItemLayout}\n                                label=\"商品分类\"\n                            >\n                                {getFieldDecorator('category', {\n                                    rules: [{type: 'array', required: true, message: '商品分类!'}],\n                                })(\n                                    <Cascader options={this.state.residences} onChange={this.onCategoryChange}/>\n                                )}\n\n                            </FormItem>\n\n                            <FormItem>\n                                <div>汰品个数</div>\n                            </FormItem>\n\n                            <FormItem>\n                                {getFieldDecorator('eliminate_amount', {\n                                    initialValue: 3,\n                                    rules: [{required: true, message: '汰品个数'}],\n                                })(\n                                    <Input placeholder=\"汰品个数\"/>\n                                )}\n                            </FormItem>\n\n                        </Card>\n\n                        <Card bordered={false}>\n                            <FormItem>\n                                <Button\n                                    type=\"primary\"\n                                    htmlType=\"submit\"\n                                >\n\n                                    计算\n                                </Button>\n                            </FormItem>\n                        </Card>\n\n                    </div>\n                </Form>\n                <Card title=\"淘汰数据\" bordered={false}>\n                    <EliminateSelectTable data={this.state.data} pfn={this.child_data.bind(this)}/>\n                </Card>\n\n            </div>\n        )\n    }\n}\n\nconst Eliminate = Form.create()(EliminateComponent);\n\nexport default Eliminate;"]},"metadata":{},"sourceType":"module"}